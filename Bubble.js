var myGamePieces=[],activePiece=0,canvasWidth=433*window.innerWidth/1e3*3/2,canvasHeight=243*window.innerWidth/1e3*3/2;const characterWidth=65,characterHeight=65;var bubbletime=0,hirab=!0,bubaudio=document.createElement("audio");function startGame(){!0==hirab?initGamePieces():initGamePiecesKata(),myGameArea.start()}document.getElementById("play").onclick=playbubble,document.getElementById("setting").onclick=settingbubble,document.getElementById("guide").onclick=guidebubble,document.getElementById("quit").onclick=quitbubble,document.getElementById("pausebutton").onclick=pausebubble,document.querySelector("#settingtableb button").onclick=setting_to_menu,document.querySelector("#guidetableb button").onclick=guide_to_menu;var myGameArea={canvas:document.createElement("canvas"),start:function(){this.canvas.width=canvasWidth,this.canvas.height=canvasHeight,this.context=this.canvas.getContext("2d"),document.body.insertBefore(this.canvas,document.body.childNodes[0]),this.frameNo=0,this.interval=setInterval(updateGameArea,20),this.canvas.addEventListener("click",function(e){var t=this.getBoundingClientRect(),n=e.clientX-t.left,a=e.clientY-t.top;n>=myGamePieces[activePiece].x&&n<=myGamePieces[activePiece].x+65&&a>=myGamePieces[activePiece].y&&a<=myGamePieces[activePiece].y+65&&++activePiece<=44&&(document.getElementById("tip").innerHTML='The next letter is "'+charactertextarray[activePiece]+'"')},!1)},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},stop:function(){clearInterval(this.interval)},end:function(){document.getElementById("tip").innerText="",document.getElementById("menu").style.display="block",document.getElementById("menu").style.backgroundImage='url("./assetBubble/winnerbubble.jpg")',document.querySelector("canvas").style.display="none",document.getElementById("playagain").style.display="block",document.getElementById("play").style.display="none",document.getElementById("setting").style.display="none",document.getElementById("guide").style.display="none",document.getElementById("quit").style.display="none",document.getElementById("pausebutton").style.visibility="hidden",this.stop(),bubaudio.pause();var e=document.createElement("audio");e.src="./assetBubble/win_music.mp3",e.play()},restart:function(){window.location.href="indexBubble.html"}};function component(e){this.image=new Image,this.image.src=e,this.character=e.substring(27,e.length-4),this.width=65,this.height=65,this.x=Math.random()*(canvasWidth-65),this.y=Math.random()*(canvasHeight-65),this.speedX=2*Math.random()-1,this.speedY=2*Math.random()-1,this.newPos=function(){this.x+=this.speedX,this.y+=this.speedY,(this.x<=0||this.x>=canvasWidth-65)&&(this.speedX=-1*this.speedX),(this.y<=0||this.y>=canvasHeight-65)&&(this.speedY=-1*this.speedY)},this.update=function(){(ctx=myGameArea.context).drawImage(this.image,this.x,this.y,this.width,this.height)}}function updateGameArea(){for(bubbletime++,document.getElementById("timecal").innerHTML=Math.floor(bubbletime/50)+"s",myGameArea.clear(),activePiece>=45&&myGameArea.end(),i=activePiece;i<45;i++)myGamePieces[i].newPos(),myGamePieces[i].update()}function playbubble(){startGame(),bubbletime=0,document.getElementById("menu").style.display="none",document.querySelector("canvas").style.display="block",document.getElementById("tip").innerText="Click 'a' to move to the next letter",document.getElementById("tip").style.backgroundColor="#f1f1f1",document.getElementById("tip").style.backgroundImage="none",document.getElementById("pausebutton").style.visibility="visible",document.getElementById("timecal").style.visibility="visible",bubaudio.src="./assetBubble/bg_music.mp3",bubaudio.play(),bubaudio.onended=function(){bubaudio.play()}}function settingbubble(){document.querySelector(".buttonbubble").style.display="none",document.getElementById("settingtableb").style.display="block"}function guidebubble(){document.querySelector(".buttonbubble").style.display="none",document.getElementById("guidetableb").style.display="block"}function quitbubble(){window.location.href="index.html"}function pausebubble(){activePiece = 0,myGameArea.stop(),document.getElementById("menu").style.display="block",document.querySelector("canvas").style.display="none",document.getElementById("tip").innerText="Welcome to BubbleClick",document.getElementById("tip").style.backgroundImage='url("./assetBubble/bg_menu.gif")',document.getElementById("pausebutton").style.visibility="hidden",document.getElementById("timecal").style.visibility="hidden",bubaudio.pause()}function setting_to_menu(){document.querySelector(".buttonbubble").style.display="block",document.getElementById("settingtableb").style.display="none",!0==(hirab=document.querySelector("#settinghirab").checked)?document.querySelector("#settinghirab").checked=!0:document.querySelector("#settingkatab").checked=!0}function guide_to_menu(){document.querySelector(".buttonbubble").style.display="block",document.getElementById("guidetableb").style.display="none"}
